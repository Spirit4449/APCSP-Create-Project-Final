/******/ (() => { // webpackBootstrap
var __webpack_exports__ = {};
/*!****************************!*\
  !*** ./src/matchmaking.js ***!
  \****************************/
// matchmaking.js

var socket = io("/");
function mmdbg(label) {
  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  try {
    console.log("[MM][".concat(new Date().toISOString(), "] ").concat(label), data);
  } catch (e) {
    console.log("[MM] ".concat(label));
  }
}
mmdbg("matchmaking page load", {
  partyId: window.location.pathname
});
var partyId = window.location.pathname.split("/").filter(Boolean).pop();
socket.on("game-started", function (data) {
  mmdbg("recv game-started", {
    partyId: data.partyId,
    foundId: data.foundId,
    gameId: data.gameId
  });
  // If either the found team or owner team
  if (partyId === data.foundId || partyId === data.partyId) {
    for (var team in data.gameData) {
      // For each team
      for (var playerKey in data.gameData[team]) {
        // For each player
        var player = data.gameData[team][playerKey];
        if (player["name"] === getCookie("name")) {
          // If name
          // Set session variables
          sessionStorage.setItem("character", player["character"]);
          sessionStorage.setItem("spawnPlatform", player["spawnPlatform"]);
          sessionStorage.setItem("spawn", player["spawn"]);
          sessionStorage.setItem("party", data.foundId);
          sessionStorage.setItem("partyMembers", data.partyMembers);
          sessionStorage.setItem("map", data.map);
        }
      }
    }
    var membersToFind = sessionStorage.getItem("membersToFind");
    var playersFound = document.getElementById("players-found");
    // Set textcontent of matchmaking players
    playersFound.textContent = "Players Found: ".concat(membersToFind, "/").concat(membersToFind);
    setTimeout(function () {
      window.location = "/game/".concat(data.gameId);
      mmdbg("navigate game", {
        gameId: data.gameId
      });
    }, 500);
  }
});

// If a player leaves, redirects back to party
socket.on("matchmaking-disconnect", function (data) {
  console.log("Got the disconnect message");
  mmdbg("recv matchmaking-disconnect", data);
  if (partyId === data.partyId) {
    window.location.href = "/party/".concat(partyId);
  }
});
function getCookie(cookieName) {
  var name = cookieName + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var cookieArray = decodedCookie.split(";");
  for (var i = 0; i < cookieArray.length; i++) {
    var cookie = cookieArray[i].trim();
    if (cookie.indexOf(name) === 0) {
      return cookie.substring(name.length);
    }
  }
  return "";
}

// Random color function to change color of background periodicaly
function getRandomColor() {
  var letters = "0123456789ABCDEF";
  var color = "#";
  for (var i = 0; i < 6; i++) {
    // Chooses a random 6 digit string
    color += letters[Math.floor(Math.random() * 16)];
  }
  return color;
}

// Function to set a random color as background
function changeBackgroundColor() {
  var background = document.querySelector(".background"); // Gets background object
  var color = getRandomColor(); // Calls random color funciton
  background.style.backgroundColor = color; // Sets background color
}
document.addEventListener("DOMContentLoaded", function () {
  setInterval(changeBackgroundColor, 5000); // Every 5 seconds background color is changed
  changeBackgroundColor();
  var leave = document.getElementById("leave");
  leave.addEventListener("click", function (event) {
    window.history.back();
  });

  // Changes text of finding players header
  var findingPlayers = document.getElementById("finding-players");
  setInterval(function () {
    findingPlayers.textContent = changeText();
  }, 1000);
  function changeText() {
    dots = [".", "..", "..."];
    var randomIndex = Math.floor(Math.random() * dots.length); // Randomly selects a dot amount from the list
    var item = dots[randomIndex];
    var text = "Finding Players ".concat(item);
    return text;
  }
  var playersFound = document.getElementById("players-found");
  var members = sessionStorage.getItem("matchmakingMembers");
  var membersToFind = sessionStorage.getItem("membersToFind");
  playersFound.textContent = "Players Found: ".concat(members, "/").concat(membersToFind);
});
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Y0FBYyxDQUFDLGlCQUFpQixDQUFDO0VBQ2pFMEIsV0FBVyxDQUFDLFlBQU07SUFDaEJLLGNBQWMsQ0FBQzlCLFdBQVcsR0FBRytCLFVBQVUsQ0FBQyxDQUFDO0VBQzNDLENBQUMsRUFBRSxJQUFJLENBQUM7RUFFUixTQUFTQSxVQUFVQSxDQUFBLEVBQUc7SUFDcEJDLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDO0lBQ3pCLElBQU1DLFdBQVcsR0FBR2pCLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNFLE1BQU0sQ0FBQyxDQUFDLEdBQUdjLElBQUksQ0FBQ2pFLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDN0QsSUFBTW1FLElBQUksR0FBR0YsSUFBSSxDQUFDQyxXQUFXLENBQUM7SUFDOUIsSUFBTUUsSUFBSSxzQkFBQWhFLE1BQUEsQ0FBc0IrRCxJQUFJLENBQUU7SUFDdEMsT0FBT0MsSUFBSTtFQUNiO0VBRUEsSUFBTXRDLFlBQVksR0FBR0MsUUFBUSxDQUFDQyxjQUFjLENBQUMsZUFBZSxDQUFDO0VBQzdELElBQU1xQyxPQUFPLEdBQUc3QyxjQUFjLENBQUNLLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQztFQUM1RCxJQUFNRCxhQUFhLEdBQUdKLGNBQWMsQ0FBQ0ssT0FBTyxDQUFDLGVBQWUsQ0FBQztFQUM3REMsWUFBWSxDQUFDRyxXQUFXLHFCQUFBN0IsTUFBQSxDQUFxQmlFLE9BQU8sT0FBQWpFLE1BQUEsQ0FBSXdCLGFBQWEsQ0FBRTtBQUN6RSxDQUFDLENBQUMsQyIsInNvdXJjZXMiOlsid2VicGFjazovL2FwY3NwLWNyZWF0ZS1wcm9qZWN0LS0tZmluYWwvLi9zcmMvbWF0Y2htYWtpbmcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbWF0Y2htYWtpbmcuanNcclxuXHJcbmNvbnN0IHNvY2tldCA9IGlvKFwiL1wiKTtcclxuZnVuY3Rpb24gbW1kYmcobGFiZWwsIGRhdGEgPSB7fSkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW01NXVske25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1dICR7bGFiZWx9YCwgZGF0YSk7XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgY29uc29sZS5sb2coYFtNTV0gJHtsYWJlbH1gKTtcclxuICB9XHJcbn1cclxubW1kYmcoXCJtYXRjaG1ha2luZyBwYWdlIGxvYWRcIiwgeyBwYXJ0eUlkOiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgfSk7XHJcblxyXG5sZXQgcGFydHlJZCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdChcIi9cIikuZmlsdGVyKEJvb2xlYW4pLnBvcCgpO1xyXG5cclxuc29ja2V0Lm9uKFwiZ2FtZS1zdGFydGVkXCIsIChkYXRhKSA9PiB7XHJcbiAgbW1kYmcoXCJyZWN2IGdhbWUtc3RhcnRlZFwiLCB7XHJcbiAgICBwYXJ0eUlkOiBkYXRhLnBhcnR5SWQsXHJcbiAgICBmb3VuZElkOiBkYXRhLmZvdW5kSWQsXHJcbiAgICBnYW1lSWQ6IGRhdGEuZ2FtZUlkLFxyXG4gIH0pO1xyXG4gIC8vIElmIGVpdGhlciB0aGUgZm91bmQgdGVhbSBvciBvd25lciB0ZWFtXHJcbiAgaWYgKHBhcnR5SWQgPT09IGRhdGEuZm91bmRJZCB8fCBwYXJ0eUlkID09PSBkYXRhLnBhcnR5SWQpIHtcclxuICAgIGZvciAoY29uc3QgdGVhbSBpbiBkYXRhLmdhbWVEYXRhKSB7XHJcbiAgICAgIC8vIEZvciBlYWNoIHRlYW1cclxuICAgICAgZm9yIChjb25zdCBwbGF5ZXJLZXkgaW4gZGF0YS5nYW1lRGF0YVt0ZWFtXSkge1xyXG4gICAgICAgIC8vIEZvciBlYWNoIHBsYXllclxyXG4gICAgICAgIGNvbnN0IHBsYXllciA9IGRhdGEuZ2FtZURhdGFbdGVhbV1bcGxheWVyS2V5XTtcclxuICAgICAgICBpZiAocGxheWVyW1wibmFtZVwiXSA9PT0gZ2V0Q29va2llKFwibmFtZVwiKSkge1xyXG4gICAgICAgICAgLy8gSWYgbmFtZVxyXG4gICAgICAgICAgLy8gU2V0IHNlc3Npb24gdmFyaWFibGVzXHJcbiAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwiY2hhcmFjdGVyXCIsIHBsYXllcltcImNoYXJhY3RlclwiXSk7XHJcbiAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwic3Bhd25QbGF0Zm9ybVwiLCBwbGF5ZXJbXCJzcGF3blBsYXRmb3JtXCJdKTtcclxuICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJzcGF3blwiLCBwbGF5ZXJbXCJzcGF3blwiXSk7XHJcbiAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwicGFydHlcIiwgZGF0YS5mb3VuZElkKTtcclxuICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJwYXJ0eU1lbWJlcnNcIiwgZGF0YS5wYXJ0eU1lbWJlcnMpO1xyXG4gICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcIm1hcFwiLCBkYXRhLm1hcCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBtZW1iZXJzVG9GaW5kID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcIm1lbWJlcnNUb0ZpbmRcIik7XHJcbiAgICBjb25zdCBwbGF5ZXJzRm91bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllcnMtZm91bmRcIik7XHJcbiAgICAvLyBTZXQgdGV4dGNvbnRlbnQgb2YgbWF0Y2htYWtpbmcgcGxheWVyc1xyXG4gICAgcGxheWVyc0ZvdW5kLnRleHRDb250ZW50ID0gYFBsYXllcnMgRm91bmQ6ICR7bWVtYmVyc1RvRmluZH0vJHttZW1iZXJzVG9GaW5kfWA7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uID0gYC9nYW1lLyR7ZGF0YS5nYW1lSWR9YDtcclxuICAgICAgbW1kYmcoXCJuYXZpZ2F0ZSBnYW1lXCIsIHsgZ2FtZUlkOiBkYXRhLmdhbWVJZCB9KTtcclxuICAgIH0sIDUwMCk7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIElmIGEgcGxheWVyIGxlYXZlcywgcmVkaXJlY3RzIGJhY2sgdG8gcGFydHlcclxuc29ja2V0Lm9uKFwibWF0Y2htYWtpbmctZGlzY29ubmVjdFwiLCAoZGF0YSkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKFwiR290IHRoZSBkaXNjb25uZWN0IG1lc3NhZ2VcIik7XHJcbiAgbW1kYmcoXCJyZWN2IG1hdGNobWFraW5nLWRpc2Nvbm5lY3RcIiwgZGF0YSk7XHJcbiAgaWYgKHBhcnR5SWQgPT09IGRhdGEucGFydHlJZCkge1xyXG4gICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBgL3BhcnR5LyR7cGFydHlJZH1gO1xyXG4gIH1cclxufSk7XHJcblxyXG5mdW5jdGlvbiBnZXRDb29raWUoY29va2llTmFtZSkge1xyXG4gIGNvbnN0IG5hbWUgPSBjb29raWVOYW1lICsgXCI9XCI7XHJcbiAgY29uc3QgZGVjb2RlZENvb2tpZSA9IGRlY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5jb29raWUpO1xyXG4gIGNvbnN0IGNvb2tpZUFycmF5ID0gZGVjb2RlZENvb2tpZS5zcGxpdChcIjtcIik7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb29raWVBcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgbGV0IGNvb2tpZSA9IGNvb2tpZUFycmF5W2ldLnRyaW0oKTtcclxuICAgIGlmIChjb29raWUuaW5kZXhPZihuYW1lKSA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gY29va2llLnN1YnN0cmluZyhuYW1lLmxlbmd0aCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiBcIlwiO1xyXG59XHJcblxyXG4vLyBSYW5kb20gY29sb3IgZnVuY3Rpb24gdG8gY2hhbmdlIGNvbG9yIG9mIGJhY2tncm91bmQgcGVyaW9kaWNhbHlcclxuZnVuY3Rpb24gZ2V0UmFuZG9tQ29sb3IoKSB7XHJcbiAgY29uc3QgbGV0dGVycyA9IFwiMDEyMzQ1Njc4OUFCQ0RFRlwiO1xyXG4gIGxldCBjb2xvciA9IFwiI1wiO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgaSsrKSB7XHJcbiAgICAvLyBDaG9vc2VzIGEgcmFuZG9tIDYgZGlnaXQgc3RyaW5nXHJcbiAgICBjb2xvciArPSBsZXR0ZXJzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2KV07XHJcbiAgfVxyXG4gIHJldHVybiBjb2xvcjtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gc2V0IGEgcmFuZG9tIGNvbG9yIGFzIGJhY2tncm91bmRcclxuZnVuY3Rpb24gY2hhbmdlQmFja2dyb3VuZENvbG9yKCkge1xyXG4gIGNvbnN0IGJhY2tncm91bmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJhY2tncm91bmRcIik7IC8vIEdldHMgYmFja2dyb3VuZCBvYmplY3RcclxuICBjb25zdCBjb2xvciA9IGdldFJhbmRvbUNvbG9yKCk7IC8vIENhbGxzIHJhbmRvbSBjb2xvciBmdW5jaXRvblxyXG4gIGJhY2tncm91bmQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7IC8vIFNldHMgYmFja2dyb3VuZCBjb2xvclxyXG59XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XHJcbiAgc2V0SW50ZXJ2YWwoY2hhbmdlQmFja2dyb3VuZENvbG9yLCA1MDAwKTsgLy8gRXZlcnkgNSBzZWNvbmRzIGJhY2tncm91bmQgY29sb3IgaXMgY2hhbmdlZFxyXG4gIGNoYW5nZUJhY2tncm91bmRDb2xvcigpO1xyXG5cclxuICBjb25zdCBsZWF2ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibGVhdmVcIik7XHJcbiAgbGVhdmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgd2luZG93Lmhpc3RvcnkuYmFjaygpO1xyXG4gIH0pO1xyXG5cclxuICAvLyBDaGFuZ2VzIHRleHQgb2YgZmluZGluZyBwbGF5ZXJzIGhlYWRlclxyXG4gIGNvbnN0IGZpbmRpbmdQbGF5ZXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmaW5kaW5nLXBsYXllcnNcIik7XHJcbiAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgZmluZGluZ1BsYXllcnMudGV4dENvbnRlbnQgPSBjaGFuZ2VUZXh0KCk7XHJcbiAgfSwgMTAwMCk7XHJcblxyXG4gIGZ1bmN0aW9uIGNoYW5nZVRleHQoKSB7XHJcbiAgICBkb3RzID0gW1wiLlwiLCBcIi4uXCIsIFwiLi4uXCJdO1xyXG4gICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBkb3RzLmxlbmd0aCk7IC8vIFJhbmRvbWx5IHNlbGVjdHMgYSBkb3QgYW1vdW50IGZyb20gdGhlIGxpc3RcclxuICAgIGNvbnN0IGl0ZW0gPSBkb3RzW3JhbmRvbUluZGV4XTtcclxuICAgIGNvbnN0IHRleHQgPSBgRmluZGluZyBQbGF5ZXJzICR7aXRlbX1gO1xyXG4gICAgcmV0dXJuIHRleHQ7XHJcbiAgfVxyXG5cclxuICBjb25zdCBwbGF5ZXJzRm91bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllcnMtZm91bmRcIik7XHJcbiAgY29uc3QgbWVtYmVycyA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJtYXRjaG1ha2luZ01lbWJlcnNcIik7XHJcbiAgY29uc3QgbWVtYmVyc1RvRmluZCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJtZW1iZXJzVG9GaW5kXCIpO1xyXG4gIHBsYXllcnNGb3VuZC50ZXh0Q29udGVudCA9IGBQbGF5ZXJzIEZvdW5kOiAke21lbWJlcnN9LyR7bWVtYmVyc1RvRmluZH1gO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbInNvY2tldCIsImlvIiwibW1kYmciLCJsYWJlbCIsImRhdGEiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJjb25zb2xlIiwibG9nIiwiY29uY2F0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZSIsInBhcnR5SWQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInBhdGhuYW1lIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwicG9wIiwib24iLCJmb3VuZElkIiwiZ2FtZUlkIiwidGVhbSIsImdhbWVEYXRhIiwicGxheWVyS2V5IiwicGxheWVyIiwiZ2V0Q29va2llIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwicGFydHlNZW1iZXJzIiwibWFwIiwibWVtYmVyc1RvRmluZCIsImdldEl0ZW0iLCJwbGF5ZXJzRm91bmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidGV4dENvbnRlbnQiLCJzZXRUaW1lb3V0IiwiaHJlZiIsImNvb2tpZU5hbWUiLCJuYW1lIiwiZGVjb2RlZENvb2tpZSIsImRlY29kZVVSSUNvbXBvbmVudCIsImNvb2tpZSIsImNvb2tpZUFycmF5IiwiaSIsInRyaW0iLCJpbmRleE9mIiwic3Vic3RyaW5nIiwiZ2V0UmFuZG9tQ29sb3IiLCJsZXR0ZXJzIiwiY29sb3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJjaGFuZ2VCYWNrZ3JvdW5kQ29sb3IiLCJiYWNrZ3JvdW5kIiwicXVlcnlTZWxlY3RvciIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldEludGVydmFsIiwibGVhdmUiLCJldmVudCIsImhpc3RvcnkiLCJiYWNrIiwiZmluZGluZ1BsYXllcnMiLCJjaGFuZ2VUZXh0IiwiZG90cyIsInJhbmRvbUluZGV4IiwiaXRlbSIsInRleHQiLCJtZW1iZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==